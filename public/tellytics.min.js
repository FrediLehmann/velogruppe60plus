var __awaiter=this&&this.__awaiter||function(t,r,c,d){return new(c=c||Promise)(function(n,e){function i(t){try{a(d.next(t))}catch(t){e(t)}}function o(t){try{a(d.throw(t))}catch(t){e(t)}}function a(t){var e;t.done?n(t.value):((e=t.value)instanceof c?e:new c(function(t){t(e)})).then(i,o)}a((d=d.apply(t,r||[])).next())})};let projectId,previousUrl=location.href;function trackEvent({name:e}){return __awaiter(this,void 0,void 0,function*(){var t=Object.assign({l:location.href,id:projectId,ts:Date.now()},location.host.includes(document.referrer)?{}:{r:document.referrer});try{yield fetch("https://tellytics.vercel.app/api/ingress/"+("pageview"===e?"view":"event"),{method:"POST",credentials:"omit",keepalive:!0,body:JSON.stringify(t)})}catch(t){}})}function checkIfPathHasChanged(t){return t.pathname===new URL(previousUrl).pathname}function trackPageView(){return __awaiter(this,void 0,void 0,function*(){yield trackEvent({name:"pageview"})})}function onPageChange(t){null==t||checkIfPathHasChanged("string"==typeof t?new URL(t,location.origin):t)||trackPageView()}(()=>{var t;if(("undefined"!=typeof window||void 0!==window.document)&&void 0===window.TLL){window.TLL=!0,projectId=null==(t=document.querySelector("script[data-tellytics-tracking-id]"))?void 0:t.getAttribute("data-tellytics-tracking-id"),trackPageView();const e=history.pushState.bind(history);history.pushState=function(...t){e(...t),onPageChange(t[2]),previousUrl=location.href},window.addEventListener("popstate",function(){onPageChange(location.href),previousUrl=location.href})}})();